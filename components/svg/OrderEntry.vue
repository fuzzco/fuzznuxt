<template>
    <svg
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        viewBox="0 0 707.57 314.25"
        class="svg-order-entry"
    >
        <defs>
            <clipPath id="a">
                <rect
                    x="239.13"
                    y="277.13"
                    width="208"
                    height="36"
                    rx="9.15"
                    fill="none"
                />
            </clipPath>
            <clipPath id="b">
                <rect
                    x="239.13"
                    y="205.13"
                    width="208"
                    height="36"
                    rx="9.15"
                    fill="none"
                />
            </clipPath>
            <clipPath id="c">
                <rect
                    x="239.13"
                    y="241.13"
                    width="208"
                    height="36"
                    rx="9.15"
                    fill="none"
                />
            </clipPath>
        </defs>
        <g>
            <g>
                <path
                    d="M296.63,174v-2.34h-11V174A3,3,0,0,1,284,176.6a6,6,0,0,0-3.32,5.29v25.73h21V181.89a6,6,0,0,0-3.31-5.29A3,3,0,0,1,296.63,174Z"
                    fill="#2e5f62"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M286.63,168.63h8a2,2,0,0,1,2,2v3a0,0,0,0,1,0,0h-12a0,0,0,0,1,0,0v-3A2,2,0,0,1,286.63,168.63Z"
                    fill="#fff"
                    stroke="#2e5f62"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="1.25"
                />
            </g>
            <g>
                <path
                    d="M240.13,91.12h-42v33a3,3,0,0,0,3,3h5.43a6.27,6.27,0,0,1,5.16,2.72l4.32,6.28h4.34l4.32-6.28a6.27,6.27,0,0,1,5.16-2.72h7.27a3,3,0,0,0,3-3Z"
                    fill="#8ffcdd"
                />
                <rect
                    ref="bagContents"
                    class="bag-contents"
                    fill="white"
                    x="195"
                    y="80"
                    width="50"
                    height="60"
                />

                <path
                    d="M219.09,135.76c-.78,4,4,8.74,2.31,17.69-1.39,7.33-7.41,11.46-13.07,13.36s-11.78,2.63-16.53,7c-8.3,7.7-8.78,24.81-2.63,35.34s14.16,14.44,27.29,14.44H396.13"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M239.45,67.46l-6.1-16.86a3,3,0,0,0-2.82-2h-23.8a3,3,0,0,0-2.82,2l-6.1,16.86a3,3,0,0,0-.18,1v55.14a3,3,0,0,0,3,3h5.43a6.27,6.27,0,0,1,5.16,2.72l4.32,6.28h4.34l4.32-6.28a6.27,6.27,0,0,1,5.16-2.72h7.27a3,3,0,0,0,3-3V68.48A3,3,0,0,0,239.45,67.46Z"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M219.09,60.36h0a8.81,8.81,0,0,1-8.56-6.71h0a.83.83,0,0,1,.81-1h15.5a.83.83,0,0,1,.8,1h0A8.79,8.79,0,0,1,219.09,60.36Z"
                    fill="#fff"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <rect
                    x="204.63"
                    y="68.63"
                    width="28"
                    height="52"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    class="bag-computer-connector"
                    ref="bagComputerConnector"
                    d="M218.63,61.12V18.62a5,5,0,0,1,5-5H431.44a5,5,0,0,1,4,2.05L487.3,86.58a5,5,0,0,0,4,2h36.3a5,5,0,0,1,5,5v68.5"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M398.13,3.62H436.5a5,5,0,0,1,4,2.05l52,70.91a5,5,0,0,0,4,2h16.62"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M442.47,41.21,483,96.58a5,5,0,0,0,4,2h16.07"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="395.63"
                    cy="3.63"
                    r="3"
                    fill="#2e5f62"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="441.63"
                    cy="38.62"
                    r="3"
                    fill="#fff"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="511.63"
                    cy="78.62"
                    r="3"
                    fill="#fff"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="503.63"
                    cy="98.62"
                    r="3"
                    fill="#2e5f62"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <g ref="checkmark">
                    <circle cx="236.13" cy="91.13" r="11" fill="#2e5f62" />
                    <polygon
                        points="234.55 98.5 230.45 91.91 231.78 91.08 235.12 96.44 240.69 84.69 242.11 85.36 235.93 98.42 234.55 98.5"
                        fill="#fff"
                    />
                </g>
            </g>
            <g>
                <g>
                    <rect
                        x="428.63"
                        y="161.63"
                        width="213"
                        height="122"
                        rx="5.79"
                        fill="none"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                    <rect
                        x="437.63"
                        y="169.63"
                        width="196"
                        height="100"
                        fill="none"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                </g>
                <g>
                    <line
                        x1="525.63"
                        y1="284.13"
                        x2="525.63"
                        y2="309.13"
                        fill="none"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                    <line
                        x1="544.63"
                        y1="284.13"
                        x2="544.63"
                        y2="309.13"
                        fill="none"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                </g>
                <circle
                    cx="535.63"
                    cy="277.62"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M516.54,308.63h38.19a4.9,4.9,0,0,1,4.9,4.9v.1a0,0,0,0,1,0,0h-48a0,0,0,0,1,0,0v-.1A4.9,4.9,0,0,1,516.54,308.63Z"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
            </g>
            <g>
                <line
                    x1="248.13"
                    y1="277.63"
                    x2="439.13"
                    y2="277.63"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <line
                    x1="248.13"
                    y1="240.63"
                    x2="439.13"
                    y2="240.63"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="434.13"
                    cy="292.12"
                    r="5.5"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="274.63"
                    cy="252.63"
                    r="2"
                    fill="#2e5f62"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="250.63"
                    cy="252.63"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="284.63"
                    cy="252.63"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="437.63"
                    cy="214.63"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="427.63"
                    cy="214.63"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="418.63"
                    cy="214.63"
                    r="2"
                    fill="#2e5f62"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <circle
                    cx="408.63"
                    cy="214.63"
                    r="2"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
            </g>
            <rect
                x="523.13"
                y="215.13"
                width="168"
                height="26"
                fill="#8ffcdd"
            />
            <g>
                <line
                    x1="537.25"
                    y1="229.4"
                    x2="529.82"
                    y2="236.84"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <line
                    x1="537.25"
                    y1="236.84"
                    x2="529.82"
                    y2="229.4"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
            </g>
            <g>
                <path
                    class="sig-1"
                    ref="sig1"
                    d="M566.67,228.64c-6.45-.43-15.76-1.75-17.28-9.43-1.38-7,5-19.68,13.6-17.41,3.46.92,5.56,4.46,6.51,7.91a40.86,40.86,0,0,1,1.12,10.18,143.39,143.39,0,0,1-4.49,37.69,13.1,13.1,0,0,1-2.11,5,4.78,4.78,0,0,1-4.82,1.91c-2-.56-3.07-2.69-3.59-4.69-1.81-6.86.37-14.36,4.58-20.08s10.24-9.86,16.57-13.08a2.5,2.5,0,0,1,1.55-.4c.69.14,1.13.8,1.64,1.28,2.21,2,5.83.71,8.18-1.17,1.49-1.19,3.71-2.59,5.06-1.22.77.77.7,2.05,1.22,3,1,1.76,3.53,1.86,5.34,1s3.22-2.39,5-3.27,4.36-.88,5.39.84"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    class="sig-2"
                    ref="sig2"
                    d="M599.32,235.69c8.71-5.33,20.53-15.54,19.55-27-.18-2.12-1.45-4.59-3.47-4.44a3.22,3.22,0,0,0-2.61,2.65,8.12,8.12,0,0,0,.38,4c1.54,5.14,4.63,9.59,6.59,14.57,2.16,5.51,3.43,11.86,1.92,17.73a3.39,3.39,0,0,1-.63,1.42,2.07,2.07,0,0,1-2.44.36,4.16,4.16,0,0,1-1.76-2c-2.42-5.07,1.35-10.73,5-13.79,3.1-2.57,7.19-5.16,11.06-6.09,4.54-1.09,4.34,6.69,4.79,9.27.29,1.67,1.27,3.45,2.94,3.75a3.57,3.57,0,0,0,2.81-.86c5.16-4.13,7.54-11.68,10.81-17.19a52.92,52.92,0,0,1,6-8.78c2-2.26,7.5-6,7.34,0-.22,8.14-2.78,22,5.89,26.58a17.68,17.68,0,0,0,8.14,1.73,76.79,76.79,0,0,0,25.66-3.86"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
            </g>
            <g>
                <g>
                    <path
                        d="M100.45,64.44c.89,25.93,7.75,27.23,9.41,31.09a4.37,4.37,0,0,1,.35,1.72h0a4.39,4.39,0,0,1-4.38,4.38h-4.1a1.52,1.52,0,0,0-1.52,1.58s.91,9-.49,13.08c-2.82,8.19-16.56,10.53-16.56,10.53a5.51,5.51,0,0,0-4.53,6.69L78.31,162,41.63,143V72.73Z"
                        fill="#fff"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                    <line
                        x1="106.78"
                        y1="86.5"
                        x2="66.29"
                        y2="90.31"
                        fill="none"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                    <circle
                        cx="93.13"
                        cy="90.13"
                        r="6.5"
                        fill="#fff"
                        stroke="#2e5f62"
                        stroke-miterlimit="10"
                        stroke-width="1.25"
                    />
                </g>
                <path
                    d="M198.44,313.62H172.09a8.51,8.51,0,0,1-8.5-8.5h0a8.51,8.51,0,0,1,8.5-8.5H188a13.75,13.75,0,0,1,13.73,13.74h0A3.26,3.26,0,0,1,198.44,313.62Z"
                    fill="#fff"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M117,282.33c-2.63-100.62-31.54-155.58-63.81-155.58-35.64,0-63.69,98.63-49.41,187.37H173.13V293.66Z"
                    fill="#8ffcdd"
                />
                <path
                    d="M44,200.81a279.56,279.56,0,0,0-6.42,64.56L116.75,282"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
                <path
                    d="M116.16,268.22c-1.87-16.38-3.36-17.82-9.1-22.63-2.77-2.32-4.79-6.52-5.44-11.43-1.25-9.35-3.57-24.27-6.52-31.49-6.37-15.61-18.84-45.51-18.84-45.51"
                    fill="none"
                    stroke="#2e5f62"
                    stroke-miterlimit="10"
                    stroke-width="1.25"
                />
            </g>
            <line
                x1="3.13"
                y1="313.63"
                x2="559.13"
                y2="313.63"
                fill="none"
                stroke="#2e5f62"
                stroke-miterlimit="10"
                stroke-width="1.25"
            />
            <path
                d="M89.17,42.79C78.88,47,68.41,32.4,50.32,38.08a26.62,26.62,0,0,0-7.7,4.16,20.74,20.74,0,0,0-4.73-9.45,9.47,9.47,0,0,0-.74-.81c-.15-.15-.3-.31-.46-.46l0,0A20.87,20.87,0,1,0,22.19,67.4a21.69,21.69,0,0,0,2.69-.19,45.4,45.4,0,0,0-2.14,19.63c2.75,24.12,11,31.58,17,33.73a9,9,0,0,0,9.48-2.22l8.64-8.85a1.27,1.27,0,0,0-.39-2,13.66,13.66,0,0,1-8.24-10.91C48.06,87.28,52.71,82.13,57.07,83c5,1,7.34,7.2,8.89,9.4a1.74,1.74,0,0,0,2,.66c2.9-1,10-6.29,14.53-16a9.89,9.89,0,0,1,12.79-4.87,18.55,18.55,0,0,0,7.17,1.54C121.83,73.76,110.72,33.89,89.17,42.79Z"
                fill="#2e5f62"
                stroke="#2e5f62"
                stroke-miterlimit="10"
            />
        </g>
    </svg>
</template>

<script>
import { timeline, styler, easing } from 'popmotion'
const { backOut } = easing

let animation

export default {
    props: {
        progress: {
            type: Number,
            default: 0
        }
    },
    async mounted() {
        await this.$nextTick()
        this.runAnimation()
    },
    methods: {
        runAnimation() {
            const stylers = {
                bagContents: styler(this.$refs.bagContents),
                checkmark: styler(this.$refs.checkmark),
                bagComputerConnector: styler(this.$refs.bagComputerConnector),
                sig1: styler(this.$refs.sig1),
                sig2: styler(this.$refs.sig2)
            }

            animation = timeline(
                [
                    {
                        track: 'bagContents',
                        from: { y: 0 },
                        to: { y: -50 }
                    },
                    {
                        track: 'checkmark',
                        from: { scale: 0 },
                        to: { scale: 1 },
                        ease: backOut
                    },
                    {
                        track: 'bagComputerConnector',
                        from: { 'stroke-dashoffset': 540 },
                        to: { 'stroke-dashoffset': 0 }
                    },
                    {
                        track: 'sig1',
                        from: { 'stroke-dashoffset': 540 },
                        to: { 'stroke-dashoffset': 0 }
                    },
                    {
                        track: 'sig2',
                        from: { 'stroke-dashoffset': 540 },
                        to: { 'stroke-dashoffset': 0 }
                    }
                ],
                {
                    ease: t => t
                }
            ).start(vals => {
                Object.keys(vals).forEach(key => stylers[key].set(vals[key]))
            })

            animation.seek(0)
            animation.pause()
        }
    },
    watch: {
        progress(newVal) {
            animation.seek(newVal)
        }
    }
}
</script>

<style lang="scss">
.svg-order-entry {
    .bag-computer-connector {
        stroke-dasharray: 540;
    }
    .sig-1 {
        stroke-dasharray: 500;
    }
    .sig-2 {
        stroke-dasharray: 520;
    }
}
</style>
